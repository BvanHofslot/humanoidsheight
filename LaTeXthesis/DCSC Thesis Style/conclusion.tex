%
% Another appendix chapter
\chapter{Conclusion}\label{chap:conclusion}
In this work, novel capture regions for the \ac{VHIP} model are proposed, which addresses the \textit{theory} part of the research objective. Furthermore, control actions that use \ac{CoM} height variations for balance are presented and results are shown on hardware on humanoid robots, which addresses the \textit{application} part of the research objective. 

For the \ac{VHIP} model, capture regions are proposed in Chapter \ref{chap:regions} considering an unilateral contact constraint, after which height constraints and force constraints are added. It could be observed that the capture region becomes smaller after addition of constraints. Also, a comparison with the \ac{LIP} and \ac{LIP} plus flywheel capture regions is made, which gives a high level measure of the potential effects of \ac{CoM} height variation. The presented capture regions are derived under the assumption that kinematic limits and joint torque limits of the robot can be approximated with a constraint on minimum and maximum height and vertical acceleration respectively. As the vertical force constrained capture regions are computed numerically, there is experimented with another control law, an \ac{MPC} law, in Chapter \ref{chap:mpc}. Based on the shape of the control input of the \ac{MPC} however,, which is constrained to be a polynomial function, there is chosen to not use this control law in application.

Based on the control law used to compute the vertical force constrained capture regions, a control law is designed for implementation in a momentum-based whole-body control framework in Chapter \ref{chap:standing}. This bang-bang control law is activated when a predefined worst-case event is met. With this control law, push recovery tests are conducted on NASA's Valkyrie and Boston Dynamics' Atlas, while the robots are standing. 

The results for Valkyrie in simulation showed that push recovery improved $9$ \% after pushing the robot in the back and $4$ \% after pushing from the side when the bang-bang control law on vertical \ac{CoM} motion was used. Remarkably, push recovery was $7$ \% worse after a frontal push when enabling the bang-bang controller. The back push tests are also conducted on hardware, using a push stick and a load sensor, were an average of $7$ \% increase in maximum recoverable push was observed. Remarkably, the vertical force constrained capture position for the same height change and vertical acceleration differed approximately $4$ \% from the \ac{CP}, so differences are observed between the \ac{VHIP} model and the results on Valkyrie.

Additional hardware tests are also conducted on Atlas with a medicine ball on a rope. However, recovery did not improve noticeably. Different initial heights for the robot are tried, as well as a tuning of a joint gain, which had no effect. In simulation however, recovery did improve when enabling the bang-bang control action.

Similar to the bang-bang control action, three actions are proposed for the use in \ac{3D} in Chapter \ref{chap:walking}. Using two variables, a control action could be chosen heuristically based on an error. Compared to a constant height control approach, recovery improved the most when pushing the robot in the back or from the front in the first part of the swing phase. 

\section{Recommendations}
The results presented in this work have demonstrated that \ac{CoM} height variations can improve balance. There are however shortcomings, both on the theoretical as the applied side of the proposed research. In the following sections, recommendations for future works are presented. First, recommendations for the extension of the proposed approaches are presented, after which a broader outlook on future works is briefly presented.
\subsection{Extending the Proposed Approach }
In this section, opportunities for improvement of the presented theory, tests and results are presented.
\subsubsection{Extension of Capture Regions}
The unilateral contact and height constrained capture regions give bounds on the capture region. However, they cannot directly be used in a control law. The vertical force constrained capture points can be used in control, but use numerical integration to find future state information. It would be interesting to explore closed-form solutions for a force constrained capture problem, without overly constraining the \ac{VHIP} like in \cite{pratt2007derivation} and \cite{koolen2016balance}. With a closed-form solution for example, the control law used in application in this thesis could be predictive, as a vertical force constrained capture position could be computed on every time instance.
\subsubsection{Improving Push Recovery Tests}
Balance control of the robots is tested in this work by testing push recovery. The load sensor measures push force accurately, but a person pushing cannot in general apply the same force in every test. With the tests with the medicine ball, the ball location could be put relatively precise. However, the push duration on the robot using these tests cannot be adjusted and is quite short, which resulted in high impacts on the robot. Furthermore, stretch in the rope and in the ball can change the \ac{CoM} height of the ball. Also, the transfer of the energy of the ball to the robot depends on the damping properties of the ball and the robot. For future push recovery tests, it could be interesting to use a device that can accurately apply force according to a desired profile over time.
\subsubsection{Standing Tests for Lowering Center of Mass Height}
The standing push recovery tests presented in this work all use an increase in \ac{CoM} height for balance control, as the initial \ac{CoM} position is inside the support polygon. With the walking tests, the \ac{CoM} height is lowered. However, the walking tests are difficult to test on hardware, because of the increased complexity of the system. It could be interesting to find a test setup, where the robot should lower the \ac{CoM} height to balance to standing. The robot can be given an initial velocity when the \ac{CoM} is outside the support polygon, that lowering the \ac{CoM} height could result in balance.
\subsubsection{Analysis of Results}
In this work, the data obtained from the robots are predominantly analyzed based on time-response and phase plots. It could for example be interesting to analyze energy consumption on the robot, when using the different control strategies. 

\subsection{Outlook}
The work in this report covers merely a small part for balancing strategies for a humanoid robot. Under the assumption of the existence of a worst-case event, where additional control was needed, control actions are proposed. In this thesis, the control actions are solely chosen based on \ac{ICP} error, data from the \ac{ICP} reference trajectory and the \ac{CoM} configuration. Also, constraints and control actions are introduced under the assumption that kinematic and torque limits can be approximated with constraints on vertical position and acceleration. 

For the future, it could be interesting to analyze \ac{CoM} height variations in legged systems further. It would be interesting to investigate when humans use height variation, and why the strategy is chosen instead of the `hip strategy' in such scenarios for example. Kinematic and force limits can play an important role, as strategies can be chosen based on kinematic range and availability of force in this range.

Also, the worst-case event to trigger a control action considered in this work can be extended. Additional information can be used, as for example an estimate of the duration of the applied disturbance. With this estimate, the control actions can be made less aggressive. This can be done by using visual feedback of the robot for example, such that an estimate can be made of the disturbance and the circumstances. 
