%
% Introduction
\chapter{Introduction} \label{chap::intro}
Humans are often exposed to dangerous tasks. This is for example the case in disaster response: entering a radioactive environment to help people after a nuclear disaster, or entering a building on fire to save a life. Next to the danger of harm, factors like time and financials can also play a role. Take for example an exploration space mission to Mars, where a human committing to such a task is in risk of harm, but also costs a lot of time and money. In all these situations, the physical versatility of the human, such as grasping with hands and walking over uneven terrain, is needed. Substitution of a human-like machine in such scenarios, which has the same benefits as a human, could be very beneficial. 

Replacing the physical human with a machine is not a new topic. There already exist texts dating before Christ, that describe a human-like machine \cite{behnke2008humanoid}. As technology became more advanced, the topic of humanoid robotics became more popular in the last decades. However, a humanoid robot that has the same physical capabilities as an average human being still does not exist. 

One of those physical capabilities is keeping balance. Humans are capable of not falling over in various terrains, configurations and subject to disturbances, while robots are frequently not. Commonly used balancing strategies for humanoid robots are control of the \ac{CoP}, `ankle' strategies, and to a lesser extent, change of body angular momentum, for example: `hip' strategies. If additional steps are included in the problem, also modification of the step time and footstep location can be used for maintaining balance. 

A common assumption behind these strategies is that the \ac{CoM} height of the robot is predefined and not to be used in balancing tasks. Reasons for this include that \textit{dynamic planning} is often conducted with a \ac{LIP} model \cite{kajita20013d}. An important advantage of the use of this model is that, by its linearity, closed-form solutions exist for the solution of the dynamics: the \ac{LIP} \textit{orbital energy} \cite{kajita1992dynamic}. The \ac{CP} \cite{pratt2006capture} and \ac{ICP} \cite{koolen2012capturability}, the `extrapolated center of mass' \cite{hof2008extrapolated} and the \ac{DCM} \cite{takenaka2009real} all rely on this \ac{LIP} orbital energy. Height trajectories can be generated for \textit{kinematic feasibility} or more human-like motion, but are disturbances on the \ac{LIP} model considered in dynamic planning. These disturbances are commonly controlled with the traditional balance control strategies. However, height variations are rarely considered as an input for balancing. Recently, the use of vertical \ac{CoM} motion in balance control appeared as a relatively new research area to explore.

\section{Related Work}
Though, the use of a variable height model in dynamic planning is a relatively longer existing research field. In \cite{pratt2007derivation}, Pratt \& Drakunov derived a \ac{2D} solution for the \textit{orbital energy} for a \ac{VHIP}. By constraining the height trajectory to be a function of the horizontal position, an analytic solution for energy became available. In \cite{englsberger2013three}, Englsberger, Ott \& Albu-Sch{\"a}ffer proposed a method using the \ac{3D} \ac{DCM} to generate a dynamic plan. This \ac{DCM} can be seen as a \ac{3D} version of the \ac{ICP} \cite{koolen2012capturability}, which allowed to linearly interpolate differences in height between \ac{DCM} knot-points in the generation of a dynamic plan.  This \ac{DCM} is extended to a time varying version by Hopkins, Hong \& Leonessa in \cite{hopkins2014humanoid}. The \ac{3D} \ac{DCM} was made time varying, such that any trajectory shape between knot-points could be used in the generation of a dynamic plan. However, an analytic solution was not available anymore and a dynamic plan had to be computed numerically. 

Recently, the use of vertical \ac{CoM} motion came in sight for the particular goal to improve balance control. Koolen, Posa \& Tedrake developed an analytic \ac{MPC} law in \cite{koolen2016balance}, using the \ac{VHIP} orbital energy derived in \cite{pratt2007derivation}. A study was conducted on the \textit{regions of attraction} of the controller: the domain of initial conditions of the pendulum-based model after which convergence to the unstable pendulum mode was still possible. These regions are comparable with the \textit{capture regions} proposed by Pratt, Carff, Drakunov \& Goswami \cite{pratt2006capture}, only the capture regions relied on a \ac{LIP}-based model. The controller was able to compute \ac{2D} closed-form solutions to the trajectory to come to a stop, but without taking kinematic or force constraints into account. In \cite{gao2017increase}, Gao, Jia \& Fu presented strategies in \ac{2D} using vertical motion. Lowering the \ac{CoM} in the current step, and applying more force and raising the \ac{CoM} in the next step, is an example of a strategy presented in the work. The dynamic model considered in the strategies is a \ac{LIP}, but with an adjusted natural frequency by a constant vertical acceleration. In \cite{caron2018balance}, the same problem was approached in \ac{3D} by Caron \& Mallein. The \ac{MPC} law was able to compute \textit{capture trajectories} for different foot orientations and initial conditions in three dimensions online using a \ac{VHIP} model.

Relying on the mentioned works, no hardware results have been shown yet in using \ac{CoM} height variation for balance control. Also, there are often no comparisons made with constant height control approaches, which makes it difficult to take the method in perspective.

\section{Research Objective}
The objective of this work is to improve balance of a humanoid robot using vertical \ac{CoM} motion. To measure \textit{improving balance}, a high-level differentiation can be made in:
\begin{itemize}
	\item Analysis of the \ac{VHIP} and comparison with the \ac{LIP}: \textit{theory}.
	\item Comparison of results obtained after application of a control law on a robot, using a common control framework to transcribe pendulum-based control commands to the joints of the robot: \textit{application}.
\end{itemize}

\section{Contributions}
The contributions of this thesis are:
\begin{itemize}
	\item \ac{VHIP} capture regions: bounds on  the capture region are derived for a \ac{VHIP} model, considering different constraints.
      \item A constrained orbital energy \ac{MPC}: with the \ac{2D} method of \cite{koolen2016balance} a \ac{MPC} law is introduced that takes kinematic constraints into account.
	\item A method to use vertical \ac{CoM} motion in an applied setting in \ac{2D}, and application of the method on NASA's Valkyrie humanoid robot and Boston Dynamics' Atlas in simulation and on hardware.
	\item An extension of the \ac{2D} method to \ac{3D}. This method is tested on Valkyrie in simulation.
\end{itemize}
\section{Thesis Outline}
The thesis is structured as follows. In Chapter \ref{chap:background}, a brief background is given on commonly used expressions in humanoid robot walking, on humanoid robotics at \ac{IHMC} and on related works to \ac{CoM} height variation. In Chapter \ref{chap:regions}, capture regions are proposed for the \ac{VHIP} model. In Chapter \ref{chap:mpc}, a \ac{2D} \ac{MPC} law is derived. In Chapter \ref{chap:standing}, a controller for \ac{2D} is presented and push recovery is tested on NASA's Valkyrie during stance, with additional results shown on Boston Dynamics' Atlas. In Chapter \ref{chap:walking}, the \ac{2D} controller is extended to \ac{3D} and push recovery is tested on Valkyrie during walking in simulation. The final chapter, Chapter \ref{chap:conclusion}, presents the conclusion and recommendations for future work.

%\subs{d}{Desired}
%\subs{r}{Reference}
%\subs{xy}{Horizontal part selected of 3D vector}
%\subs{z}{Vertical part selected of vector}