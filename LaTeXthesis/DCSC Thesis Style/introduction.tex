%
% Introduction
\chapter{Introduction} \label{chap::intro}
Humans are often exposed to dangerous tasks. This is the case, for example, in disaster response: exploring a radioactive environment to help people after a nuclear disaster, or entering a building on fire to save a life. Another example is an exploration space mission to Mars, where a human committing to such a task is in risk of harm, but also costs a lot of time and money. In all these situations, the physical versatility of the human, such as the ability to grasp with hands and to walk over uneven terrain, is needed. Substitution of a human-like machine in such scenarios, which has similar benefits as a human, could be very beneficial. 

Replacing the physical human with a machine is not a new topic. There already exist ancient texts, that describe a human-like machine \cite{behnke2008humanoid}. As technology became more advanced, the topic of humanoid robotics became more popular in the last decades. However, a humanoid robot that has the same physical capabilities as an average human being still does not exist. One of those physical capabilities is maintaining balance. Humans are capable of not falling over in various terrains, configurations and subject to disturbances, while robots are frequently not. Commonly used balancing strategies for humanoid robots are taking a step, control of the \ac{CoP} (`ankle strategies') and, to a lesser extent, change of body angular momentum (for example: `hip strategies'). 

A common assumption behind these strategies is that the \ac{CoM} height of the robot is predefined and not to be used in balancing tasks. By constraining the height, a degree of freedom of the system is defined and the dynamics of the system are known. Furthermore, if height changes are small, the system can be approximated with a \ac{LIP} model \cite{kajita20013d} in the generation of a dynamic reference plan for the robot. An important advantage of this model is that, by its linearity, closed-form solutions exist to the dynamics, as for example the \ac{LIP} orbital energy \cite{kajita1992dynamic}. The linear dynamics of the \ac{LIP} are a saddle point with one stable eigenvalue and one unstable eigenvalue. The unstable mode has been referred to as the \ac{CP} \cite{pratt2006capture}, the \ac{ICP} \cite{koolen2012capturability}, the extrapolated center of mass \cite{hof2008extrapolated} and the \ac{DCM} \cite{takenaka2009real}, which all relate to the \ac{LIP} orbital energy. 

\section{Center of Mass Height Variation}
In addition to a \ac{LIP}-based dynamical plan, \ac{CoM} height reference trajectories for the robot are traditionally generated for kinematic feasibility \cite{koolen2016design, kuindersma2016optimization} or more human-like motion, but are disturbances on the \ac{LIP} model considered in dynamic planning. These disturbances are commonly rejected with the traditional balance control strategies. Efforts have been made in incorporating \ac{CoM} height variation in the dynamic reference plan. Examples are the \ac{VHIP} orbital energy \cite{pratt2007derivation}, the \ac{3D} \ac{DCM} \cite{englsberger2013three} and the time-varying \ac{DCM} \cite{hopkins2014humanoid}. The works either introduce artificial constraints \cite{pratt2007derivation} or cope with larger computation times \cite{hopkins2014humanoid}.

Recently, the use of the \ac{CoM} height variation came in sight with the particular goal to improve balance control. Using a \ac{VHIP} model, height changes of the pendulum tip can influence the horizontal dynamics, which can be used as a control input for balance. Some works have considered this control input by formulating a \ac{MPC} law \cite{koolen2016balance, caron2018balance} for computing capture trajectories: trajectories that will result in the point-mass to stop. In both works, the objective is to let the point-mass converge within the current ground contact without taking additional steps, based on the initial configuration and velocity. This is also known as `0-step' capture \cite{koolen2012capturability}. In \ac{MPC}, fast computation times are even more needed than in dynamic planning, as a reference trajectory is evaluated every control tick. Control rates are commonly between $200$ [Hz] and $800$ [Hz] on humanoid robots \cite{koolen2016design, kuindersma2016optimization}. The methods therefore introduce artificial constraints to solve the problem online.

Relying on the mentioned work, no hardware results have been shown yet in using \ac{CoM} height variation for balance control. Also, if a method is proposed, no comparison is made with constant height approaches in simulation. Therefore, it is difficult to judge the differences in performance between the proposed control law and for example a \ac{LIP}-based controller in an applied setting. In this report, comparison between predefined height approaches and approaches that use \ac{CoM} height variation for balance will be central in the evaluation of the presented theory and methods.

\section{Research Objective}
The objective of this work is to improve balance of a humanoid robot using vertical \ac{CoM} motion. To measure the `improving balance', a high-level differentiation is made between:
\begin{itemize}
	\item \textbf{Theory}: analysis of the \ac{VHIP} and comparison with the \ac{LIP}.
	\item \textbf{Application}: comparison of results obtained after application of a control law on a robot, using a commonly used control framework to transcribe pendulum-based control commands to the joints of the robot. In this control law, fast computation times are needed.
\end{itemize}

\section{Contributions}
The contributions in this work are novel capture regions for the \ac{VHIP} model, which addresses the theoretical part of the research objective. Also, results are presented on hardware using \ac{CoM} height variation for balance control, which addresses the applied part of the research objective. More specifically, relating to theoretical contribution, this work presents:
\begin{itemize}
	\item \textbf{\ac{VHIP} capture regions}: bounds on the initial states of a \ac{VHIP} model, from which convergence of the unstable mode is possible. The regions are obtained by incrementally adding constraints to the \ac{VHIP} model. First, only unilateral contact constraints are considered. After this, height constraints are added and finally, vertical force constraints are added.
      \item \textbf{Kinematic constrained orbital energy trajectories}: with the method of \cite{koolen2016balance} a \ac{MPC} law is introduced that takes kinematic constraints into account. This method is not further used in application, as is the polynomial function used in the control law is overly constraining the \ac{VHIP} dynamics.
\end{itemize}

Relating to the objective of comparison of applied results, this work presents:
\begin{itemize}
	\item \textbf{A method that uses \ac{CoM} height variation for balancing while standing}: a bang-bang control law on vertical acceleration. This control law is tested by conducting push recovery on NASA's Valkyrie humanoid robot and Boston Dynamics' Atlas in simulation and on hardware.
	\item \textbf{A method that uses \ac{CoM} height variation for balancing while walking}: an extension of the standing method for walking scenarios. This method is tested on Valkyrie in simulation. Additionally, one hardware result on Atlas is presented.
\end{itemize}
\section{Thesis Outline}
The remainder of this thesis is structured as follows. In Chapter \ref{chap:background}, a brief background is given on commonly used expressions in legged systems research, on humanoid robotics at \ac{IHMC} and on related works to \ac{CoM} height variation. In Chapter \ref{chap:regions}, capture regions are derived for the \ac{VHIP} model. In Chapter \ref{chap:mpc}, a \ac{2D} \ac{MPC} law is derived, which is not further used in application. In Chapter \ref{chap:standing}, a controller for \ac{2D} is presented and push recovery is tested on NASA's Valkyrie while the robot is standing, with additional results shown on Boston Dynamics' Atlas. In Chapter \ref{chap:walking}, the \ac{2D} controller is extended to \ac{3D} and push recovery is tested on Valkyrie during walking in simulation. Additionally, a hardware result on Atlas is presented. The final chapter, Chapter \ref{chap:conclusion}, presents the conclusion and recommendations for future work.

%\subs{d}{Desired}
%\subs{r}{Reference}
%\subs{xy}{Horizontal part selected of 3D vector}
%\subs{z}{Vertical part selected of vector}